<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>cargoserviceM2M &#8212; issLab2025 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=649a27d8" />
    <link rel="stylesheet" type="text/css" href="_static/sphinxdoc.css?v=34905f61" />
    <script src="_static/documentation_options.js?v=f2a433a1"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Cargo24" href="Cargo24.html" />
    <link rel="prev" title="issLab2025" href="index.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="Cargo24.html" title="Cargo24"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="issLab2025"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">issLab2025 1.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">cargoserviceM2M</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="cargoservicem2m">
<h1>cargoserviceM2M<a class="headerlink" href="#cargoservicem2m" title="Link to this heading">¶</a></h1>
<section id="m2m-start">
<h2>M2M start<a class="headerlink" href="#m2m-start" title="Link to this heading">¶</a></h2>
<ol class="arabic">
<li><p>Si veda: <a class="reference external" href="file:///C:/Didattica2024/qak24/iss24Material/docs/_build/html/SpringBootIntro.html?highlight=spring">file:///C:/Didattica2024/qak24/iss24Material/docs/_build/html/SpringBootIntro.html?highlight=spring</a></p></li>
<li><p>Eseguire <a class="reference external" href="https://spring.io/">https://spring.io/</a></p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/springiostart.png"><img alt="_images/springiostart.png" class="align-center" src="_images/springiostart.png" style="width: 90%;" />
</a>
</div></blockquote>
</li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">unzip</span>
<span class="n">gradlew</span> <span class="n">build</span>
</pre></div>
</div>
<p>Creare:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">src</span>\<span class="n">main</span>\<span class="n">resources</span>\<span class="n">application</span><span class="o">.</span><span class="n">properties</span>
<span class="n">src</span>\<span class="n">main</span>\<span class="n">resources</span>\<span class="n">banner</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
</section>
<section id="m2m-first-run">
<h2>M2M first run<a class="headerlink" href="#m2m-first-run" title="Link to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gradlew</span> <span class="n">booturn</span> <span class="p">(</span><span class="n">INFO</span> <span class="n">messages</span><span class="p">)</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">9111</span><span class="o">/</span> <span class="p">(</span><span class="n">Whitelabel</span> <span class="n">Error</span> <span class="n">Page</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="m2m-required-library">
<h2>M2M required library<a class="headerlink" href="#m2m-required-library" title="Link to this heading">¶</a></h2>
<p>Inserire (necessaria per l’applicazione):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">applibs</span>
    <span class="n">cargoproduct</span><span class="o">-</span><span class="mf">1.0</span><span class="o">.</span><span class="n">jar</span>
</pre></div>
</div>
</section>
<section id="m2m-build-gradle">
<h2>M2M build.gradle<a class="headerlink" href="#m2m-build-gradle" title="Link to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">build</span><span class="o">.</span><span class="n">gradle</span>
    <span class="n">dependencies</span>
    <span class="n">plugins</span> <span class="o">...</span>
        <span class="nb">id</span> <span class="s1">&#39;org.springframework.boot&#39;</span> <span class="n">version</span> <span class="s1">&#39;3.3.4&#39;</span>
        <span class="nb">id</span> <span class="s1">&#39;eclipse&#39;</span>
        <span class="nb">id</span> <span class="s1">&#39;application&#39;</span>

    <span class="n">version</span> <span class="o">=</span> <span class="s1">&#39;1.0&#39;</span>
    <span class="n">repositories</span> <span class="p">{</span>
        <span class="n">mavenCentral</span><span class="p">()</span>
        <span class="n">flatDir</span> <span class="p">{</span>   <span class="n">dirs</span> <span class="s1">&#39;../unibolibs&#39;</span>      <span class="p">}</span>
        <span class="n">flatDir</span> <span class="p">{</span>   <span class="n">dirs</span> <span class="s1">&#39;applibs&#39;</span>           <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">dependencies</span><span class="p">{</span>
        <span class="o">...</span>
        <span class="n">implementation</span> <span class="s1">&#39;com.googlecode.json-simple:json-simple:1.1.1&#39;</span>
        <span class="n">implementation</span> <span class="n">group</span><span class="p">:</span> <span class="s1">&#39;org.json&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;json&#39;</span><span class="p">,</span> <span class="n">version</span><span class="p">:</span> <span class="s1">&#39;20180130&#39;</span>

        <span class="o">/*</span> <span class="n">Elasticsearch</span>   <span class="o">*/</span>
        <span class="n">implementation</span><span class="p">(</span><span class="s2">&quot;net.logstash.logback:logstash-logback-encoder:7.3&quot;</span><span class="p">)</span>
        <span class="o">//</span><span class="n">ATTENZIONE</span> <span class="n">ALLA</span> <span class="n">COMPATIBILITA</span> <span class="n">DELLA</span> <span class="n">VESRSIONE</span>

        <span class="n">implementation</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;uniboInterfaces&#39;</span>
        <span class="n">implementation</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;2p301&#39;</span>
        <span class="n">implementation</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;unibo.basicomm23-1.0&#39;</span>
        <span class="n">implementation</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;cargoproduct-1.0&#39;</span>

    <span class="n">application</span> <span class="p">{</span>
        <span class="o">//</span><span class="n">Define</span> <span class="n">the</span> <span class="n">main</span> <span class="k">class</span> <span class="nc">for</span> <span class="n">the</span> <span class="n">application</span><span class="o">.</span>
        <span class="n">mainClassName</span>    <span class="o">=</span> <span class="s1">&#39;unibo.disi.cargoserviceM2M.CargoserviceM2MApplication&#39;</span>
    <span class="p">}</span>

<span class="n">gradlew</span> <span class="n">eclipse</span>
<span class="n">gradlew</span> <span class="n">build</span>
</pre></div>
</div>
</section>
<section id="m2m-application-and-run">
<h2>M2M application and run<a class="headerlink" href="#m2m-application-and-run" title="Link to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">new</span> <span class="n">package</span> <span class="n">src</span>\<span class="n">main</span>\<span class="n">java</span>\<span class="n">unibo</span>\<span class="n">disi</span>\<span class="n">cargoserviceM2M</span>\<span class="n">controller</span>
<span class="n">M2MCargoServiceController</span><span class="o">.</span><span class="n">java</span>
<span class="n">gradlew</span> <span class="n">run</span>
</pre></div>
</div>
</section>
<section id="m2m-usage">
<h2>M2M usage<a class="headerlink" href="#m2m-usage" title="Link to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Eseguire</span><span class="p">:</span> <span class="n">PSLCallerHTTP</span><span class="o">.</span><span class="n">java</span>
</pre></div>
</div>
</section>
<section id="m2m-logging">
<h2>M2M logging<a class="headerlink" href="#m2m-logging" title="Link to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">src</span>\<span class="n">main</span>\<span class="n">resources</span>\<span class="n">logback</span><span class="o">.</span><span class="n">xml</span>
   <span class="n">definire</span> <span class="n">i</span> <span class="o">&lt;</span><span class="n">pettern</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Definire il logger:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">public</span> <span class="k">class</span> <span class="nc">CargoserviceM2MApplication</span> <span class="p">{</span>
    <span class="n">public</span>  <span class="n">final</span> <span class="n">static</span> <span class="n">Logger</span> <span class="n">logger</span>  <span class="o">=</span> <span class="n">org</span><span class="o">.</span><span class="n">slf4j</span><span class="o">.</span><span class="n">LoggerFactory</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;m2m&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>Osservare i messaggi di log in  <code class="docutils literal notranslate"><span class="pre">logs\m2m.log</span></code></p>
</section>
<section id="m2m-testing-local">
<h2>M2M testing  local<a class="headerlink" href="#m2m-testing-local" title="Link to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">java</span><span class="o">/</span><span class="n">unibo</span><span class="o">/</span><span class="n">disi</span><span class="o">/</span><span class="n">cargoserviceM2M</span><span class="o">/</span><span class="n">config</span><span class="o">/</span><span class="n">RestTemplateConfig</span><span class="o">.</span><span class="n">java</span>
<span class="n">src</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">java</span><span class="o">/</span><span class="n">unibo</span><span class="o">/</span><span class="n">disi</span><span class="o">/</span><span class="n">cargoserviceM2M</span><span class="o">/</span><span class="n">CargoserviceM2MApplicationTests</span><span class="o">.</span><span class="n">java</span>
<span class="n">gradlew</span> <span class="n">build</span> <span class="n">ESEGUE</span> <span class="n">I</span> <span class="n">TESTS</span> <span class="o">-</span><span class="n">x</span> <span class="n">test</span> <span class="n">LI</span> <span class="n">ESCLUDE</span>
</pre></div>
</div>
</section>
<section id="m2m-testing-using-elk">
<h2>M2M testing using ELK<a class="headerlink" href="#m2m-testing-using-elk" title="Link to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="n">logback</span><span class="o">.</span><span class="n">xml</span>  <span class="o">-</span> <span class="n">aggiungere</span> <span class="n">ELK</span><span class="p">:</span>
<span class="n">In</span> <span class="n">build</span><span class="o">.</span><span class="n">gradle</span> <span class="o">-</span> <span class="n">aggiungere</span> <span class="n">dipendenza</span> <span class="n">per</span> <span class="n">Elasticsearch</span>
</pre></div>
</div>
<p>Il file <code class="docutils literal notranslate"><span class="pre">logstash.conf</span></code> nel progetto (<code class="docutils literal notranslate"><span class="pre">cargo2025\src\main\resources\logstash.conf</span></code>)
che definisce il file <code class="docutils literal notranslate"><span class="pre">yml</span></code>
che attiva <code class="docutils literal notranslate"><span class="pre">logstash</span></code> e <code class="docutils literal notranslate"><span class="pre">elasticsearch</span></code> definisce i <strong>nomi degli index</strong>
da selezionare in <strong>Kibana</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cargo</span><span class="o">-</span><span class="n">logs</span><span class="o">-</span>
<span class="n">m2m</span><span class="o">-</span><span class="n">logs</span><span class="o">-</span>
</pre></div>
</div>
<p>Eseguire <code class="docutils literal notranslate"><span class="pre">src/test/java/unibo/disi/cargoserviceM2M/CargoserviceM2MApplicationTests.java</span></code>
ed esplorare <strong>Kibana in http://localhost:5601/</strong>.</p>
</section>
<section id="m2m-on-docker">
<h2>M2M on Docker<a class="headerlink" href="#m2m-on-docker" title="Link to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Dockerfile</span>
<span class="n">cargoserviceM2M</span><span class="o">.</span><span class="n">bat</span>
<span class="n">cargoserviceM2M</span><span class="o">.</span><span class="n">yml</span>

<span class="n">docker</span><span class="o">-</span><span class="n">compose</span> <span class="o">-</span><span class="n">f</span> <span class="n">cargoservicem2m</span><span class="o">.</span><span class="n">yml</span>  <span class="o">-</span><span class="n">p</span> <span class="n">cargoservicem2m</span> <span class="n">up</span>
</pre></div>
</div>
</section>
<section id="m2m-discoverable">
<h2>M2M discoverable<a class="headerlink" href="#m2m-discoverable" title="Link to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Dipendenza</span> <span class="n">per</span> <span class="n">Eureka</span> <span class="n">Client</span>
<span class="n">implementation</span> <span class="s1">&#39;com.netflix.eureka:eureka-client:1.10.18&#39;</span>
    <span class="o">//</span><span class="mf">1.10.18</span> <span class="n">compatibile</span> <span class="n">con</span> <span class="n">immagine</span> <span class="n">Spring</span> <span class="n">Cloud</span> <span class="n">Netflix</span> <span class="mf">3.</span><span class="n">x</span>
<span class="o">//</span> <span class="n">Dipendenza</span> <span class="n">per</span> <span class="n">Jersey</span> <span class="n">Client</span> <span class="p">(</span><span class="n">per</span> <span class="n">fare</span> <span class="n">richieste</span> <span class="n">HTTP</span><span class="p">)</span>
<span class="n">implementation</span> <span class="s1">&#39;com.sun.jersey:jersey-client:1.19.1&#39;</span>
<span class="n">implementation</span> <span class="s1">&#39;com.netflix.servo:servo-core:0.13.2&#39;</span>

<span class="n">cargoservice</span><span class="p">:</span>
    <span class="n">image</span><span class="p">:</span> <span class="n">cargoservice</span><span class="p">:</span><span class="mf">3.0</span>
    <span class="c1">#image: natbodocker/cargoservice:3.0</span>
    <span class="n">container_name</span><span class="p">:</span> <span class="n">cargoservice</span>
    <span class="n">environment</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">EUREKA_CLIENT_SERVICEURL_DEFAULTZONE</span><span class="o">=</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">eureka</span><span class="p">:</span><span class="mi">8761</span><span class="o">/</span><span class="n">eureka</span><span class="o">/</span>


<span class="n">La</span> <span class="n">classe</span> <span class="n">main</span><span class="o">.</span><span class="n">java</span><span class="o">.</span><span class="n">EurekaServiceConfig</span> <span class="n">definisce</span> <span class="n">le</span> <span class="n">proprietà</span> <span class="n">rilevanti</span> <span class="k">del</span> <span class="n">servizio</span> <span class="n">da</span> <span class="n">registare</span><span class="p">:</span>


<span class="k">if</span><span class="p">(</span> <span class="n">CommUtils</span><span class="o">.</span><span class="n">getEnvvarValue</span><span class="p">(</span><span class="s2">&quot;EUREKA_CLIENT_SERVICEURL_DEFAULTZONE&quot;</span><span class="p">)</span><span class="o">!=</span><span class="n">null</span><span class="p">)</span>
    <span class="n">main</span><span class="o">/</span><span class="n">resources</span><span class="o">/</span><span class="n">eureka</span><span class="o">-</span><span class="n">client</span><span class="o">.</span><span class="n">properties</span>


<span class="n">CommUtils</span><span class="o">.</span><span class="n">registerService</span><span class="p">(</span> <span class="n">main</span><span class="o">.</span><span class="n">java</span><span class="o">.</span><span class="n">EurekaServiceConfig</span><span class="p">()</span> <span class="p">)</span>

<span class="n">discoveryclient</span> <span class="o">=</span> <span class="n">main</span><span class="o">.</span><span class="n">java</span><span class="o">.</span><span class="n">EurekaServiceConfig</span><span class="o">.</span><span class="n">myRegister</span><span class="p">(</span> <span class="n">main</span><span class="o">.</span><span class="n">java</span><span class="o">.</span><span class="n">EurekaServiceConfig</span><span class="p">()</span> <span class="p">)</span>
    <span class="o">//</span><span class="n">val</span> <span class="n">discoveryclient</span> <span class="o">=</span> <span class="n">CommUtils</span><span class="o">.</span><span class="n">registerService</span><span class="p">(</span> <span class="n">main</span><span class="o">.</span><span class="n">java</span><span class="o">.</span><span class="n">EurekaServiceConfig</span><span class="p">()</span> <span class="p">)</span>
    <span class="n">CommUtils</span><span class="o">.</span><span class="n">outblue</span><span class="p">(</span><span class="s2">&quot;discoveryclient=$discoveryclient &quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">cargoserviceM2M</a><ul>
<li><a class="reference internal" href="#m2m-start">M2M start</a></li>
<li><a class="reference internal" href="#m2m-first-run">M2M first run</a></li>
<li><a class="reference internal" href="#m2m-required-library">M2M required library</a></li>
<li><a class="reference internal" href="#m2m-build-gradle">M2M build.gradle</a></li>
<li><a class="reference internal" href="#m2m-application-and-run">M2M application and run</a></li>
<li><a class="reference internal" href="#m2m-usage">M2M usage</a></li>
<li><a class="reference internal" href="#m2m-logging">M2M logging</a></li>
<li><a class="reference internal" href="#m2m-testing-local">M2M testing  local</a></li>
<li><a class="reference internal" href="#m2m-testing-using-elk">M2M testing using ELK</a></li>
<li><a class="reference internal" href="#m2m-on-docker">M2M on Docker</a></li>
<li><a class="reference internal" href="#m2m-discoverable">M2M discoverable</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="index.html"
                          title="previous chapter">issLab2025</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="Cargo24.html"
                          title="next chapter">Cargo24</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/cargoserviceM2M.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="Cargo24.html" title="Cargo24"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="issLab2025"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">issLab2025 1.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">cargoserviceM2M</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2024, ANatali.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    </div>
  </body>
</html>